<!-- ========================= -->
<!-- THEORETISCHE HINTERGRÜNDE -->
<!-- ========================= -->

<section data-use-template="teilkapitel" data-titel="Theoretische Hintergründe"></section>

<section data-title="Was ist ein Webservice?">
    <section data-title="Server, Service, Webservice">
        <!--
            Service: Softwarekomponente stellt Funktion in einem System zur Verfügung
            Server: Bietet entfernten Zugriff (meist über das Internet) auf einen Service -> M2M!
            Webservice: Nutzt die Webtechnologien HTTP (und ggf. XML, JSON) zur Implementierung des Servers (basiert also auf einem Webserver)
        -->
    </section>

    <section data-title="Webanwendung vs. Webservice">
        <!--
            Definition Anwendung mit
            Beispielen für Anwendungen anhand Bildern
            Webanwendung: Anwendung auf Basis der Webtechnologien HTML, CSS, JS
            Nutzen im Hintergrund oft Webservices um Daten zu beschaffen oder zu verschicken
        -->
    </section>

    <section data-title="Das HTTP-Übertragungsprotokoll">
        <!--
                HTTP-Folie ohne Randtext
                Dafür kleiner Text obendrüber oder darunter
                Alles mittig zentriert
        -->
    </section>

    <section data-title="Gängige Webservice-Arten">
        <!--
            Grundidee schon sehr alt. Spätestens 1999.
            1998 XML-RPC (Microsoft)
            1999 SOAP (Microsoft, IBM und andere)
            2000 REST (seit 2014 nennenswerte Verbreitung)
            2007 Webhooks (nicht-standardisiert, nur ein User Defined HTTP-Callback für asynchrone Ereignisse)

            Je mit kurzer Zusammenfassung der Funktionsweise und Mini-Beispiel

            Weitere: 2014 OData, 2012 GraphQL
        -->
    </section>

    <section data-title="SOAP vs. REST">
        <!--
            Comic-Bild: Get Coffee!
            Alter Vergleich aus den Folien mit Pferdewagen?
        -->
    </section>

    <section data-title="Webservice oder API?">
        <!--
            Ggf. kürzer / besser formulieren?
            Screenshot oder Beispiel für traditionelle API: WIN32 C
        -->
    </section>
</section>

<section data-title="Einsatzgebiete von Webservices">
    <section data-title="Fallbeispiel: Reiseportal">
        <!-- Bild mit kurzer Erklärung -->
    </section>

    <section data-title="Fallbeispiel: Business-to-Business">
        <!-- Bild mit kurzer Erklärung -->
    </section>

    <section data-title="Fallbeispiel: Serviceorientierte Architektur">
        <!-- Neues Bild -->
    </section>

    <section data-title="Weitere Beispiele">
        <!-- Alte Seite: Beispiele für öffentliche Webservices -->
    </section>
</section>

<section data-title="REST-Webservices im Detail">
    <section data-title="Representational State Transfer">
        <!--
            Erklärungstext als alter Folie
            Representational: Content Negotation für Datenformate
                - HTTP Anfrage und Antwort zeigen
                - Mit enthaltenem Beispiel für JSON-Daten
            State Transfer: Zustandsloser Server, gesamtes Objekt hin- und her schicken
                -> Auch hier ggf. mit Beispiel-Anfrage/Antwort (Objekt anlegen -> ID + Location Header)
        -->
    </section>

    <section data-title="Ressourcen">
    </section>

    <section data-title="Collections">
        <!--
            Mit Bild analog zu Michaels Folien: Collection enthält die Ressourcen
        -->
    </section>

    <section data-title="Stores">
        <!--
            Eher selten anzutreffen aber möglich
        -->
    </section>

    <section data-title="Actions">
        <!-- Eigentlich Controller genannt, Begriff aber zweideutig! -->
    </section>
</section>

<section data-title="Fallbeispiel: Wastebin">
    <section data-title="Funktionsumfang der App">
        <!--
            Screenshots als LibreOffice-Folien mit Kurzbeschreibung aus README
        -->
    </section>

    <section data-title="Datenmodell">
        <!--
            Aus README übernehmen
        -->
    </section>

    <section data-title="REST-Webservice">
        <!--
            Aus README übernehmen
        -->
    </section>

    <section data-title="Typische HTTP-Anfragen">
        <!--
            Alte Skriptseite dazu, aber neu strukturiert und angepasst an das Beispiel
            Screenshots aus HTTPie vorne anstellen unter Erklärtext
        -->
    </section>
</section>

<section data-title="Übungsaufgaben" data-background-color="rgb(231, 221, 141)">
    <!-- TODO Vervollständigen -->
    <section data-title="Aufgabe 1: Ein kleines Webservice-Quiz">
        <article>
            <lsx-tab-pages>
                <lsx-tab-page title="Aufgabe 1.1">
                    <lsx-quiz>
                        <lsx-exercise title="HTTP-Verben">
                            <lsx-question
                                type = "single-choice"
                                text = "a) Was bewirkt das HTTP-Verb POST?"
                            >
                                <lsx-answer>
                                    Es werden bereits vorhandene Daten vom Server abgerufen.
                                </lsx-answer>
                                <lsx-answer>
                                    Es werden Daten auf dem Server gelöscht (POST = Postpone).
                                </lsx-answer>
                                <lsx-answer correct>
                                    Es werden Daten werden zur Verarbeitung an den Server geschickt.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "b) Was bewirkt das HTTP-Verb DELETE?"
                            >
                                <lsx-answer>
                                    Die ausgewählten Daten werden im Browser gelöscht.
                                </lsx-answer>
                                <lsx-answer correct>
                                    Die ausgewählten Daten werden auf dem Server gelöscht.
                                </lsx-answer>
                                <lsx-answer>
                                    Es wird geprüft, ob die Daten gelöscht werden können.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "c) Was bewirkt das HTTP-Verb GET?"
                            >
                                <lsx-answer correct>
                                    Es werden Daten vom Server abgerufen (zum Beispiel der HTML-Code einer Webseite).
                                </lsx-answer>
                                <lsx-answer>
                                    Es wird eine Dateiliste vom Server mit den Namen aller Dateien einer Webseite abgerufen.
                                </lsx-answer>
                                <lsx-answer>
                                    Der Inhalt einer Datei wird vom Browser an den Server übertragen.
                                </lsx-answer>
                            </lsx-question>
                        </lsx-exercise>
                    </lsx-quiz>
                </lsx-tab-page>

                <lsx-tab-page title="Aufgabe 1.2">
                    <lsx-quiz>
                        <lsx-exercise title="HTTP-Statuscodes">
                            <lsx-question
                                type = "single-choice"
                                text = "a) Was bedeutet der Statuscode 401 Unauthorized?"
                            >
                                <lsx-answer>
                                    Die gesuchten Daten wurden nicht gefunden.
                                </lsx-answer>
                                <lsx-answer>
                                    Die gewünschte Funktion wurde nicht ausprogrammiert.
                                </lsx-answer>
                                <lsx-answer correct>
                                    Die gewünschte Funktion darf nicht ausgeführt werden.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "b) Was bedeutet der Statuscode 503 Service Unavailble?"
                            >
                                <lsx-answer correct>
                                    Es ist ein temporärer Fehler aufgetreten, bitte später nochmal versuchen.
                                </lsx-answer>
                                <lsx-answer>
                                    Es ist ein schwerwiegender Fehler aufgetreten. Nichts geht mehr.
                                </lsx-answer>
                                <lsx-answer>
                                    Die gesuchte Information wurde nicht gefunden. Bitte anders suchen.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "c) Welcher Statuscode signalisiert, dass eine Seite nicht gefunden wurde?"
                            >
                                <lsx-answer>
                                    200
                                </lsx-answer>
                                <lsx-answer>
                                    301
                                </lsx-answer>
                                <lsx-answer correct>
                                    404
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "d) Welcher Statuscode wird geschickt, wenn alles okay ist?"
                            >
                                <lsx-answer>
                                    100
                                </lsx-answer>
                                <lsx-answer correct>
                                    200
                                </lsx-answer>
                                <lsx-answer>
                                    300
                                </lsx-answer>
                            </lsx-question>
                        </lsx-exercise>
                    </lsx-quiz>
                </lsx-tab-page>

                <lsx-tab-page title="Aufgabe 1.3">
                    <lsx-quiz>
                        <lsx-exercise title="REST-Webservices">
                            <lsx-question
                                type = "single-choice"
                                text = "a) Wofür steht die Abkürzung REST?"
                            >
                                <lsx-answer>
                                    <a href="https://www.youtube.com/watch?v=qx9HEn8aq1c" target="_blank">Rest in Peace</a>
                                </lsx-answer>
                                <lsx-answer correct>
                                    Representational State Transfer
                                </lsx-answer>
                                <lsx-answer>
                                    Representational Standard Transfer
                                </lsx-answer>
                                <lsx-answer>
                                    Represent Every State Through HTTP
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "b) Eine Ressource sollte immer einer Collection oder einem Store angehören?"
                            >
                                <lsx-answer correct>
                                    Wahr
                                </lsx-answer>
                                <lsx-answer>
                                    Falsch
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "c) Worin unterscheiden sich Collections und Stores?"
                            >
                                <lsx-answer>
                                    Bei einer Collection werden neue Ressourcen vom Client eingefügt, bei einem Store vom Server.
                                </lsx-answer>
                                <lsx-answer correct>
                                    Bei einer Collection legt der Server fest, welche URL die Ressourcen erhalten, bei einem Store der Client.
                                </lsx-answer>
                                <lsx-answer>
                                    In eine Collection können nur gleichartige Ressourcen eingefügt werden, in einen Store alle Arten.
                                </lsx-answer>
                                <lsx-answer>
                                    In einer Collection besitzen alle Ressourcen eine natürliche Reihenfolge, in einem Store nicht.
                                </lsx-answer>
                                <lsx-answer>
                                    In einer Collection werden die Ressourcen dauerhaft gespeichert, in einem Store nicht.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "d) Welches HTTP-Verb wird typischerweise zum Anlegen neuer Ressourcen genutzt?"
                            >
                                <lsx-answer correct>
                                    POST
                                </lsx-answer>
                                <lsx-answer>
                                    PUT
                                </lsx-answer>
                                <lsx-answer>
                                    PATCH
                                </lsx-answer>
                                <lsx-answer>
                                    HEAD
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "e) Welches HTTP-Verb wird typischerweise zum Ändern einer Ressource genutzt?"
                            >
                                <lsx-answer>
                                    POST
                                </lsx-answer>
                                <lsx-answer correct>
                                    PUT
                                </lsx-answer>
                                <lsx-answer>
                                    PATCH
                                </lsx-answer>
                                <lsx-answer>
                                    HEAD
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "f) Welche Aufgabe besitzt das HTTP-Verb PATCH?"
                            >
                                <lsx-answer>
                                    Anlegen einer neuen Collection.
                                </lsx-answer>
                                <lsx-answer>
                                    Anlegen einer neuen Ressource.
                                </lsx-answer>
                                <lsx-answer>
                                    Ändern der URL einer Ressource.
                                </lsx-answer>
                                <lsx-answer correct>
                                    Ändern einzelner Felder einer Ressource.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "g) Warum sollten Actions niemals mit einer GET-Anfrage ausgelöst werden?"
                            >
                                <lsx-answer correct>
                                    Weil GET-Anfragen keine Seiteneffekte haben dürfen.
                                </lsx-answer>
                                <lsx-answer>
                                    Weil es mit DO ein besser geeignetes HTTP-Verb dafür gibt.
                                </lsx-answer>
                                <lsx-answer>
                                    Man darf schon, aber nur wenn die Action ein Ergebnis liefert.
                                </lsx-answer>
                            </lsx-question>
                
                            <lsx-question
                                type = "single-choice"
                                text = "h) Welche der folgenden Antworten entspricht nicht dem HATEOAS-Prinzip?"
                            >
                                <lsx-answer correct>
                                    <source-code language="json">
                                        {
                                            "id": 3110,
                                            "first_name": "Gilian",
                                            "last_name": "Anderson",
                                        }
                                    </source-code>
                                </lsx-answer>
                                <lsx-answer>
                                    <source-code language="json">
                                        {
                                            "id": 2512,
                                            "first_name": "David",
                                            "last_name": "Duchovny",
                                            "_links": {
                                                "as-actor": {
                                                    "href": "/actors/3686/credited-as-actor"
                                                },
                                                "as-director": {
                                                    "href": "actors/3686/credited-as-director"
                                                }
                                            }
                                        }
                                    </source-code>
                                </lsx-answer>
                            </lsx-question>
                        </lsx-exercise>
                    </lsx-quiz>
                </lsx-tab-page>
            </lsx-tab-pages>
        </article>
        <aside>
            <p>
                It's Quiz Time! Hier können Sie Ihr neues Wissen rund um HTTP und seine
                Verwendung in Webservices testen. Viel Erfolg dabei! 🐧
            </p>
            <img src="shared/quiz.png" class="img-fluid d-block" style="max-width: 20em;"/>
            <p>
                <small>
                    Bildnachweis:
                    <a href="https://pixabay.com/illustrations/quiz-tiles-letters-red-game-test-2058883/" target="_blank">Pixabay: 905513</a>
                </small>
            </p>
        </aside>
    </section>

    <section data-title="Aufgabe 2: Vorsicht, Falle!">
        <!--
            Kleines Spiel: Code-Beispiele (URL/HTTP-Methode + Beispieldaten) zu Webservice-Art zuordnen
            Beispiele werden hierfür in einem Karussell eins nach dem anderen gezeigt
            Zuordnung über eine Button-Leiste darunter: REST, SOAP, XML-RPC, Kein Webservice
            Am Ende eine Übersicht der richtigen/falschen Antworten ggf. mit Erklärung

            Neues Tag in lsx-extra-tags
        -->
    </section>

    <section data-title="Aufgabe 3: Art Institute of Chicago">
    </section>

    <section data-title="Aufgabe 4: Circle of Life">
    </section>

    <section data-title="Aufgabe 5: Kleiderkreisel">
    </section>

    <section data-title="Aufgabe 6: Wir eröffnen ein Kino">
    </section>
</section>

<!-- ================ -->
<!-- VERTIEFUNG: CORS -->
<!-- ================ -->

<section data-use-template="teilkapitel" data-titel="Vertiefung: CORS"></section>

<section data-title="Cross-Origin-Resource-Sharing (CORS)">
    <section data-title="Cross-Site-Scripting-Attacken ">
        <!--
        XSS-Attacken
        CORS als clientseitiger Sicherheitsmechanismus
        -->
    </section>

    <section data-title="Funktionsweise von CORS">
        <!--
        Generelle überlegungen zur Funktionsweise
        OPTIONS PreFlight im Detail anhand Beispiel
        -->
    </section>

    <section data-title="Zusätzliche Header Fields">
        <!--
        HTTP Header Fields für CORS
        -->
    </section>
</section>

<section data-title="Fallbeispiel: Notebook-as-a-Service">
    <section data-title="Probleme bei fehlender CORS-Unterstützung">
        <!--
            Architekturskizze -> CORS-Relevant weil Gateway eine andere Origin hat
            Screenshot des abgebrochenen Requests, wenn CORS-Reglen im Gateway fehlen
            JavaScript-Code bekommt aus Sicherheitsgründen nur einen generischen Fehler gemeldet
        -->
    </section>

    <section data-title="CORS-Regeln in der Gateway-Konfiguration">
        <!--
            Auszug aus der Gateway-Konfiguration
            Erklärung der Regeln
        -->
    </section>

    <section data-title="Erfolgreicher OPTIONS Pre-Flight">
    </section>
</section>

<section data-title="Übungsaufgaben" data-background-color="rgb(231, 221, 141)">
    <section data-title="Aufgabe 1: Ein kleines CORS-Quiz">
        <article>
            <lsx-quiz>
                <lsx-exercise>
                    <lsx-question
                        type = "single-choice"
                        text = "Wofür steht die Abkürzung CORS?"
                    >
                        <lsx-answer>Content Oriented Remote Service</lsx-answer>
                        <lsx-answer>Content On Remote Server</lsx-answer>
                        <lsx-answer correct>Cross-Origin Resource Sharing</lsx-answer>
                    </lsx-question>

                    <lsx-question
                        type = "multiple-choice"
                        text = "Welche URL-Bestandteile bilden die „Herkunft” (Origin) einer Webseite?"
                    >
                        <lsx-answer correct>Protokoll</lsx-answer>
                        <lsx-answer correct>Hauptdomain des Hostnamens</lsx-answer>
                        <lsx-answer>Der komplette Hostname</lsx-answer>
                        <lsx-answer correct>Portnummer</lsx-answer>
                        <lsx-answer>Pfad</lsx-answer>
                        <lsx-answer>URL-Parameter</lsx-answer>
                        <lsx-answer>Anker</lsx-answer>
                    </lsx-question>

                    <lsx-question
                        type = "multiple-choice"
                        text = "Warum sind Anfragen an einen anderen Host als die „Herkunft” (Origin) einer Seite potentiell gefährlich?"
                    >
                        <lsx-answer>Weil der fremde Host den Inhalt der Anfragen nicht verarbeiten kann.</lsx-answer>
                        <lsx-answer correct>Weil der Aufruf aus Sicht des Servers möglicherweise gar nicht erwünscht ist.</lsx-answer>
                        <lsx-answer correct>Weil Angreifer die Originalseite optisch nachbauen und die Benutzer so zu unerwünschten Aktionen verleiten könnten.</lsx-answer>
                        <lsx-answer>Weil die aufrufende Seite vom selben Entwicklerteam wie der Server entwickelt werden sollte.</lsx-answer>
                        <lsx-answer correct>Weil XSS-Attacken häufig auf den Aufruf fremder Hosts, auf denen man bereits eingeloggt ist, abzielen.</lsx-answer>
                    </lsx-question>

                    <lsx-question
                        type = "multiple-choice"
                        text = "Welches sind „sichere“ HTTP-Verben, die nie einen <tt>OPTIONS</tt> Pre-Flight auslösen?"
                    >
                        <lsx-question-line>
                            <lsx-answer correct><tt>GET</tt></lsx-answer>
                            <lsx-answer><tt>PUT</tt></lsx-answer>
                            <lsx-answer><tt>POST</tt></lsx-answer>
                            <lsx-answer><tt>PATCH</tt></lsx-answer>
                            <lsx-answer><tt>DELETE</tt></lsx-answer>
                            <lsx-answer correct><tt>HEAD</tt></lsx-answer>
                        </lsx-question-line>
                    </lsx-question>

                    <lsx-question
                        type = "single-choice"
                        text = "Welche Aussage verbirgt sich hinter dem Header Field <src-code language='http'>Vary: Origin</src-code>?"
                    >
                        <lsx-answer correct>Der Server signalisiert damit, dass der Inhalt seiner Antwort vom Header Field „Origin“ in der Anfrage abhängig ist.</lsx-answer>
                        <lsx-answer>Der Server gibt in diesem Header Field die URLs der erlaubten Herkünfte“ (Origins) für entfernte Aufrufe an.</lsx-answer>
                        <lsx-answer>Der Client frägt damit beim Server an, ob ein geplanter Zugriff auf eine Ressource zulässig wäre.</lsx-answer>
                        <lsx-answer>Der Client teilt dem Server damit mit, dass die aktuelle Anfrage keine „Herkunft“ (Origin) besitzt.</lsx-answer>
                    </lsx-question>

                    <lsx-question
                        type         = "assignment"
                        text         = "Unter anderem die folgenden Header Fields werden beim OPTIONS Pre-Flight zwischen Browser und Webserver ausgetauscht. Ordnen Sie ihnen die jeweils richtige Bedeutung zu:"
                        label-length = "20em"
                    >
                        <lsx-assignment answer="Anfrage: HTTP-Verb der tatsächlich geplanten Anfrage">
                            <tt>Access-Control-Request-Method</tt>
                        </lsx-assignment>
                        <lsx-assignment answer="Anfrage: Zusätzlicher Header Fields der geplanten Anfrage">
                            <tt>Access-Control-Request-Headers</tt>
                        </lsx-assignment>
                        <lsx-assignment answer="Antwort: Erlaubte Herkunft („Origin“) beim Zugriff auf die angefragte Ressource">
                            <tt>Access-Control-Allow-Origin</tt>
                        </lsx-assignment>
                        <lsx-assignment answer="Antwort: Erlaubte HTTP-Verben beim Zugriff auf die angefragte Ressource">
                            <tt>Access-Control-Allow-Methods</tt>
                        </lsx-assignment>
                    </lsx-question>

                    <lsx-question
                        type = "single-choice"
                        text = "Im Header Field <tt>Access-Control-Allow-Origin</tt> kann eine Liste aller erlaubten „Herkünfte“ (Origins) enthalten sein."
                    >
                        <lsx-quesiton-line>
                            <lsx-answer>Wahr</lsx-answer>
                            <lsx-answer correct>Falsch</lsx-answer>
                        </lsx-quesiton-line>
                    </lsx-question>

                    <lsx-question
                        type = "single-choice"
                        text = "Welche besagt das Header Field <src-code language='http'>Access-Control-Allow-Origin: *</src-code> in einer HTTP-Antwort?"
                    >
                        <lsx-answer>Dass entfernte Zugriff auf die angefragte Ressource prinzipiell nicht zulässig sind.</lsx-answer>
                        <lsx-answer>Dass der Zugriff geschützt ist und die erlaubten „Herkünfte“ (Origins) beim Server angefragt werden müssen.</lsx-answer>
                        <lsx-answer correct>Dass Webseiten jeglicher „Herkunft“ (Origin) auf die anfragte Ressource zugreifen können.</lsx-answer>
                    </lsx-question>
                </lsx-exercise>
            </lsx-quiz>
        </article>
        <aside>
            <p>
                Bei CORS dreht sich alles darum, Inhalte zu teilen. Hier können Sie stattdessen
                Ihr <i>Wissen</i> teilen und überprüfen.
            </p>
            <img src="shared/quiz.png" class="img-fluid d-block" style="max-width: 20em;"/>
            <p>
                <small>
                    Bildnachweis:
                    <a href="https://pixabay.com/illustrations/quiz-tiles-letters-red-game-test-2058883/" target="_blank">Pixabay: 905513</a>
                </small>
            </p>
        </aside>
    </section>

    <section data-title="Aufgabe 2: Versuche am lebenden Objekt">
        <!-- 
            Anhand NaaS:
            OPTIONS Pre-Flight im Browser anschauen
            Header Fields interpretieren
            Änderungen an der Gateway-Konfiguration vornehmen -> Kaputt machen und wieder reparieren
        -->
    </section>
</section>
